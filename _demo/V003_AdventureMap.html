<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>å•è¯å°è¶…äºº - å†’é™©åœ°å›¾</title>
    <style>
        /* å¯¼å…¥å­—ä½“ */
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Comic+Neue:wght@400;700&display=swap');
        
        /* VDS ç³»ç»Ÿå˜é‡ */
        :root {
            --primary-color: #7FB3D3;
            --accent-color: #F4A6A6;
            --bg-color: #F8F6F0;
            --success-color: #A8D8A8;
            --warning-color: #F4D03F;
            --glow-color: #FFE5B4;
            --text-primary: #4A4A4A;
            --text-secondary: #6B6B6B;
            --text-light: #8A8A8A;
            --font-display: 'Fredoka One', cursive;
            --font-body: 'Comic Neue', 'PingFang SC', sans-serif;
        }
        
        /* å…³é”®å¸§åŠ¨ç”» */
        @keyframes jellyBounce {
            0% { transform: scale(1); }
            30% { transform: scale(1.25, 0.75); }
            40% { transform: scale(0.75, 1.25); }
            50% { transform: scale(1.15, 0.85); }
            65% { transform: scale(0.95, 1.05); }
            75% { transform: scale(1.05, 0.95); }
            100% { transform: scale(1); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-6px); }
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 8px var(--glow-color); }
            50% { box-shadow: 0 0 20px var(--glow-color), 0 0 30px var(--glow-color); }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        /* åŸºç¡€æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-body);
            background: linear-gradient(135deg, 
                rgba(127, 179, 211, 0.1) 0%, 
                rgba(168, 216, 168, 0.1) 50%, 
                rgba(244, 166, 166, 0.1) 100%),
                var(--bg-color);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* å®‰å…¨åŒºé€‚é… */
        .safe-area {
            padding: 88px 20px 34px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            max-width: 400px;
            margin: 0 auto;
        }
        
        /* é¡¶éƒ¨HUD */
        .top-hud {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            animation: fadeIn 0.8s ease-out;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255, 255, 255, 0.9);
            padding: 12px 16px;
            border-radius: 20px;
            box-shadow: 0 4px 16px rgba(127, 179, 211, 0.2);
        }
        
        .user-avatar {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--primary-color), #A8C8E1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }
        
        .user-details {
            display: flex;
            flex-direction: column;
        }
        
        .user-name {
            font-size: 15px;
            font-weight: bold;
            color: var(--text-primary);
        }
        
        .user-grade {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .progress-info {
            background: rgba(255, 255, 255, 0.9);
            padding: 12px 16px;
            border-radius: 16px;
            box-shadow: 0 4px 16px rgba(127, 179, 211, 0.2);
            text-align: center;
        }
        
        .progress-text {
            font-size: 12px;
            color: var(--text-secondary);
            display: block;
        }
        
        .progress-number {
            font-size: 16px;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        /* åœ°å›¾æ ‡é¢˜ */
        .map-title {
            text-align: center;
            margin-bottom: 24px;
        }
        
        .map-title h1 {
            font-family: var(--font-display);
            font-size: 24px;
            color: var(--primary-color);
            margin-bottom: 8px;
        }
        
        .map-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        /* åœ°å›¾å®¹å™¨ */
        .map-container {
            flex: 1;
            position: relative;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 24px;
            padding: 24px 24px 40px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(127, 179, 211, 0.15);
            min-height: 600px;
        }
        
        /* å…³å¡ç½‘æ ¼ */
        .levels-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            max-width: 300px;
            margin: 0 auto;
            padding-bottom: 20px;
        }
        
        /* å…³å¡èŠ‚ç‚¹ */
        .level-node {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            margin: 0 auto;
            box-shadow: 0 4px 16px rgba(74, 74, 74, 0.15);
        }
        
        /* èŠ‚ç‚¹çŠ¶æ€æ ·å¼ */
        .level-node.locked {
            background: linear-gradient(135deg, #D3D3D3, #E8E8E8);
            color: var(--text-light);
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        .level-node.available {
            background: linear-gradient(135deg, var(--primary-color), #A8C8E1);
            color: white;
            animation: pulse 2s ease-in-out infinite;
            box-shadow: 0 6px 20px rgba(127, 179, 211, 0.4);
        }
        
        .level-node.completed {
            background: linear-gradient(135deg, var(--success-color), #C8E6C8);
            color: white;
            box-shadow: 0 6px 20px rgba(168, 216, 168, 0.4);
        }
        
        .level-node.current {
            background: linear-gradient(135deg, var(--warning-color), #F7DC6F);
            color: var(--text-primary);
            animation: glow 2s ease-in-out infinite;
            box-shadow: 0 8px 25px rgba(244, 208, 63, 0.5);
            transform: scale(1.1);
        }
        
        .level-node:hover:not(.locked) {
            transform: translateY(-4px) scale(1.1);
            box-shadow: 0 8px 20px rgba(74, 74, 74, 0.25);
        }
        
        .level-node:active:not(.locked) {
            animation: jellyBounce 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        /* èŠ‚ç‚¹æ ‡ç­¾ */
        .node-label {
            position: absolute;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.9);
            padding: 6px 10px;
            border-radius: 10px;
            font-size: 11px;
            color: var(--text-secondary);
            white-space: nowrap;
            box-shadow: 0 2px 8px rgba(74, 74, 74, 0.1);
            z-index: 10;
            max-width: 90px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* çŠ¶æ€å›¾æ ‡ */
        .level-node::after {
            content: '';
            position: absolute;
            bottom: -2px;
            right: -2px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        
        .level-node.locked::after {
            content: 'ğŸ”’';
            background: #999;
        }
        
        .level-node.completed::after {
            content: 'âœ“';
            background: var(--success-color);
        }
        
        .level-node.current::after {
            content: 'â–¶';
            background: var(--accent-color);
            animation: pulse 1s ease-in-out infinite;
        }
        
        /* åº•éƒ¨æ“ä½œæ  */
        .bottom-actions {
            display: flex;
            gap: 12px;
            animation: fadeIn 1s ease-out 0.3s both;
        }
        
        .action-btn {
            flex: 1;
            border: none;
            border-radius: 20px;
            padding: 16px;
            font-size: 14px;
            font-weight: bold;
            font-family: var(--font-body);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            min-height: 52px;
            box-shadow: 0 4px 16px rgba(74, 74, 74, 0.1);
        }
        
        .action-btn.primary {
            background: linear-gradient(135deg, var(--primary-color), #A8C8E1);
            color: white;
        }
        
        .action-btn.secondary {
            background: linear-gradient(135deg, var(--accent-color), #F7C4C4);
            color: var(--text-primary);
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(74, 74, 74, 0.2);
        }
        
        .action-btn:active {
            animation: jellyBounce 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        /* å…³å¡é¢„è§ˆå¼¹çª— */
        .level-preview {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .level-preview.show {
            opacity: 1;
            pointer-events: auto;
        }
        
        .preview-card {
            background: var(--bg-color);
            border-radius: 24px;
            padding: 32px 24px;
            max-width: 320px;
            width: 90%;
            text-align: center;
            box-shadow: 0 16px 48px rgba(74, 74, 74, 0.2);
            transform: scale(0.8);
            transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        .level-preview.show .preview-card {
            transform: scale(1);
        }
        
        .preview-icon {
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, var(--primary-color), #A8C8E1);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
        }
        
        .preview-title {
            font-family: var(--font-display);
            font-size: 22px;
            color: var(--primary-color);
            margin-bottom: 12px;
        }
        
        .preview-desc {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 24px;
            line-height: 1.5;
        }
        
        .preview-actions {
            display: flex;
            gap: 12px;
        }
        
        .preview-btn {
            flex: 1;
            border: none;
            border-radius: 16px;
            padding: 14px 20px;
            font-size: 14px;
            font-weight: bold;
            font-family: var(--font-body);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        .preview-btn.start {
            background: linear-gradient(135deg, var(--success-color), #C8E6C8);
            color: var(--text-primary);
        }
        
        .preview-btn.cancel {
            background: rgba(74, 74, 74, 0.1);
            color: var(--text-secondary);
        }
        
        .preview-btn:hover {
            transform: translateY(-2px);
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 480px) {
            .safe-area {
                padding: 88px 16px 34px;
            }
            
            .level-node {
                width: 60px;
                height: 60px;
                font-size: 16px;
            }
            
            .levels-grid {
                gap: 20px;
                margin-bottom: 20px;
            }
            
            .node-label {
                top: 70px;
                font-size: 10px;
                padding: 4px 8px;
                max-width: 80px;
            }
        }
    </style>
</head>
<body>
    <div class="safe-area">
        <!-- é¡¶éƒ¨HUD -->
        <div class="top-hud">
            <div class="user-info">
                <div class="user-avatar">ğŸ“</div>
                <div class="user-details">
                    <div class="user-name" id="userName">å°è¶…äºº</div>
                    <div class="user-grade" id="userGrade">ä¸‰å¹´çº§</div>
                </div>
            </div>
            
            <div class="progress-info">
                <span class="progress-text">è¿›åº¦</span>
                <span class="progress-number" id="progressNumber">1/20</span>
            </div>
        </div>
        
        <!-- åœ°å›¾æ ‡é¢˜ -->
        <div class="map-title">
            <h1>ğŸ—ºï¸ å†’é™©åœ°å›¾</h1>
            <div class="map-subtitle">é€‰æ‹©å…³å¡å¼€å§‹ä½ çš„å•è¯å†’é™©ä¹‹æ—…</div>
        </div>
        
        <!-- åœ°å›¾å®¹å™¨ -->
        <div class="map-container">
            <div class="levels-grid" id="levelsGrid">
                <!-- å…³å¡èŠ‚ç‚¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- åº•éƒ¨æ“ä½œæ  -->
        <div class="bottom-actions">
            <button class="action-btn secondary" onclick="openSettings()">âš™ï¸ è®¾ç½®</button>
            <button class="action-btn primary" onclick="continueAdventure()">ğŸ¯ ç»§ç»­å†’é™©</button>
        </div>
    </div>
    
    <!-- å…³å¡é¢„è§ˆå¼¹çª— -->
    <div class="level-preview" id="levelPreview">
        <div class="preview-card">
            <div class="preview-icon" id="previewIcon">ğŸ“–</div>
            <div class="preview-title" id="previewTitle">ç¬¬1å…³</div>
            <div class="preview-desc" id="previewDesc">å­¦ä¹ 5ä¸ªåŸºç¡€å•è¯ï¼Œå®Œæˆæ‰‹å†™ç»ƒä¹ </div>
            <div class="preview-actions">
                <button class="preview-btn cancel" onclick="closePreview()">å–æ¶ˆ</button>
                <button class="preview-btn start" onclick="startLevel()">å¼€å§‹</button>
            </div>
        </div>
    </div>
    
    <script>
        // VDS æ ¸å¿ƒå·¥å…·é›†
        const VDS = {
            colors: {
                primary: '#7FB3D3',
                accent: '#F4A6A6',
                bg: '#F8F6F0',
                success: '#A8D8A8',
                warning: '#F4D03F',
                glow: '#FFE5B4'
            },
            animations: {
                easing: 'cubic-bezier(0.68, -0.55, 0.265, 1.55)',
                duration: {
                    fast: 0.15,
                    normal: 0.3,
                    slow: 0.6
                }
            }
        };
        
        /**
         * åœºæ™¯ç®¡ç†å™¨ - å¤„ç†é¡µé¢è·³è½¬
         * @param {string} sceneFile - ç›®æ ‡åœºæ™¯æ–‡ä»¶å
         */
        function goToScene(sceneFile) {
            document.body.style.transition = 'opacity 0.3s ease-in-out';
            document.body.style.opacity = 0;
            setTimeout(() => {
                window.location.href = sceneFile;
            }, 300);
        }
        
        /**
         * éŸ³æ•ˆæ¨¡æ‹Ÿå™¨
         * @param {string} soundType - éŸ³æ•ˆç±»å‹
         */
        function playSound(soundType) {
            console.log(`ğŸ”Š æ’­æ”¾éŸ³æ•ˆ: ${soundType}`);
        }
        
        /**
         * å†’é™©åœ°å›¾æ§åˆ¶å™¨
         */
        class AdventureMapController {
            constructor() {
                this.currentLevel = 1;
                this.maxLevel = 20;
                this.userProgress = 1;
                this.selectedLevel = null;
                this.init();
            }
            
            /**
             * åˆå§‹åŒ–æ§åˆ¶å™¨
             */
            init() {
                this.loadUserData();
                this.generateLevels();
                this.updateUI();
                this.bindEvents();
                this.animateIn();
            }
            
            /**
             * åŠ è½½ç”¨æˆ·æ•°æ®
             */
            loadUserData() {
                // æ¨¡æ‹Ÿä»æœ¬åœ°å­˜å‚¨åŠ è½½ç”¨æˆ·æ•°æ®
                const userData = {
                    name: 'å°è¶…äºº',
                    grade: 'ä¸‰å¹´çº§',
                    progress: 3,
                    currentLevel: 3
                };
                
                this.userProgress = userData.progress;
                this.currentLevel = userData.currentLevel;
                
                document.getElementById('userName').textContent = userData.name;
                document.getElementById('userGrade').textContent = userData.grade;
            }
            
            /**
             * ç”Ÿæˆå…³å¡èŠ‚ç‚¹
             */
            generateLevels() {
                const levelsGrid = document.getElementById('levelsGrid');
                levelsGrid.innerHTML = '';
                
                // å…³å¡ä¸»é¢˜é…ç½®
                const levelThemes = [
                    { icon: 'ğŸ', name: 'åŸºç¡€è¯æ±‡' },
                    { icon: 'ğŸ ', name: 'å®¶åº­ç”¨å“' },
                    { icon: 'ğŸ±', name: 'åŠ¨ç‰©ä¸–ç•Œ' },
                    { icon: 'ğŸŒˆ', name: 'é¢œè‰²å½©è™¹' },
                    { icon: 'ğŸµ', name: 'éŸ³ä¹è‰ºæœ¯' },
                    { icon: 'ğŸš—', name: 'äº¤é€šå·¥å…·' },
                    { icon: 'ğŸ•', name: 'ç¾é£Ÿå¤©åœ°' },
                    { icon: 'âš½', name: 'è¿åŠ¨å¥èº«' },
                    { icon: 'ğŸ“š', name: 'å­¦ä¹ ç”¨å“' },
                    { icon: 'ğŸŒŸ', name: 'è‡ªç„¶æ™¯è§‚' },
                    { icon: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦', name: 'å®¶åº­æˆå‘˜' },
                    { icon: 'ğŸª', name: 'å¨±ä¹æ´»åŠ¨' },
                    { icon: 'ğŸ¥', name: 'èº«ä½“éƒ¨ä½' },
                    { icon: 'ğŸŒ', name: 'ä¸–ç•Œåœ°ç†' },
                    { icon: 'ğŸ”¬', name: 'ç§‘å­¦æ¢ç´¢' },
                    { icon: 'ğŸ¨', name: 'è‰ºæœ¯åˆ›ä½œ' },
                    { icon: 'ğŸ’¼', name: 'èŒä¸šä½“éªŒ' },
                    { icon: 'ğŸŒº', name: 'æ¤ç‰©èŠ±å‰' },
                    { icon: 'ğŸ­', name: 'æƒ…æ„Ÿè¡¨è¾¾' },
                    { icon: 'ğŸ†', name: 'ç»ˆææŒ‘æˆ˜' }
                ];
                
                for (let i = 1; i <= this.maxLevel; i++) {
                    const levelNode = document.createElement('div');
                    const theme = levelThemes[i - 1] || { icon: 'ğŸ“–', name: `ç¬¬${i}å…³` };
                    
                    // ç¡®å®šå…³å¡çŠ¶æ€
                    let status = 'locked';
                    if (i < this.userProgress) {
                        status = 'completed';
                    } else if (i === this.userProgress) {
                        status = 'current';
                    } else if (i === this.userProgress + 1) {
                        status = 'available';
                    }
                    
                    levelNode.className = `level-node ${status}`;
                    levelNode.innerHTML = `
                        ${theme.icon}
                        <div class="node-label">${theme.name}</div>
                    `;
                    
                    // ç»‘å®šç‚¹å‡»äº‹ä»¶
                    if (status !== 'locked') {
                        levelNode.addEventListener('click', () => this.showLevelPreview(i, theme));
                    }
                    
                    levelsGrid.appendChild(levelNode);
                }
            }
            
            /**
             * æ›´æ–°UIæ˜¾ç¤º
             */
            updateUI() {
                document.getElementById('progressNumber').textContent = `${this.userProgress}/${this.maxLevel}`;
            }
            
            /**
             * æ˜¾ç¤ºå…³å¡é¢„è§ˆ
             * @param {number} levelNum - å…³å¡ç¼–å·
             * @param {object} theme - å…³å¡ä¸»é¢˜
             */
            showLevelPreview(levelNum, theme) {
                playSound('button_click');
                
                this.selectedLevel = levelNum;
                
                document.getElementById('previewIcon').textContent = theme.icon;
                document.getElementById('previewTitle').textContent = `ç¬¬${levelNum}å…³ - ${theme.name}`;
                document.getElementById('previewDesc').textContent = `å­¦ä¹ ${theme.name}ç›¸å…³çš„5ä¸ªå•è¯ï¼Œå®Œæˆé»˜å†™æŒ‘æˆ˜`;
                
                const preview = document.getElementById('levelPreview');
                preview.classList.add('show');
            }
            
            /**
             * ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
             */
            bindEvents() {
                // é”®ç›˜å¿«æ·é”®
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.closePreview();
                    }
                    if (e.key === 'Enter' && this.selectedLevel) {
                        this.startLevel();
                    }
                });
                
                // ç‚¹å‡»èƒŒæ™¯å…³é—­é¢„è§ˆ
                document.getElementById('levelPreview').addEventListener('click', (e) => {
                    if (e.target.id === 'levelPreview') {
                        this.closePreview();
                    }
                });
            }
            
            /**
             * å…³é—­å…³å¡é¢„è§ˆ
             */
            closePreview() {
                const preview = document.getElementById('levelPreview');
                preview.classList.remove('show');
                this.selectedLevel = null;
            }
            
            /**
             * å¼€å§‹å…³å¡
             */
            startLevel() {
                if (this.selectedLevel) {
                    playSound('level_start');
                    
                    // ä¿å­˜å½“å‰å…³å¡åˆ°æœ¬åœ°å­˜å‚¨
                    localStorage.setItem('currentLevel', this.selectedLevel);
                    
                    // è·³è½¬åˆ°å•è¯å­¦ä¹ é¡µé¢
                    goToScene('./V004_WordLearning.html');
                }
            }
            
            /**
             * ç»§ç»­å†’é™©ï¼ˆè¿›å…¥å½“å‰å…³å¡ï¼‰
             */
            continueAdventure() {
                playSound('button_click');
                
                // ç›´æ¥è¿›å…¥å½“å‰å…³å¡
                localStorage.setItem('currentLevel', this.currentLevel);
                goToScene('./V004_WordLearning.html');
            }
            
            /**
             * é¡µé¢å…¥åœºåŠ¨ç”»
             */
            animateIn() {
                // å…³å¡èŠ‚ç‚¹ä¾æ¬¡å‡ºç°
                const nodes = document.querySelectorAll('.level-node');
                nodes.forEach((node, index) => {
                    node.style.opacity = '0';
                    node.style.transform = 'translateY(20px)';
                    
                    setTimeout(() => {
                        node.style.transition = 'all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55)';
                        node.style.opacity = '1';
                        node.style.transform = 'translateY(0)';
                    }, index * 100);
                });
            }
        }
        
        /**
         * å…³é—­å…³å¡é¢„è§ˆ
         */
        function closePreview() {
            mapController.closePreview();
        }
        
        /**
         * å¼€å§‹å…³å¡
         */
        function startLevel() {
            mapController.startLevel();
        }
        
        /**
         * ç»§ç»­å†’é™©
         */
        function continueAdventure() {
            mapController.continueAdventure();
        }
        
        /**
         * æ‰“å¼€è®¾ç½®
         */
        function openSettings() {
            playSound('button_click');
            goToScene('./V006_Statistics.html');
        }
        
        // åˆå§‹åŒ–åœ°å›¾æ§åˆ¶å™¨
        let mapController;
        
        document.addEventListener('DOMContentLoaded', function() {
            mapController = new AdventureMapController();
        });
    </script>
</body>
</html>